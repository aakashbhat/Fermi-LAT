\section{Prediction for unassociated sources in 3FGL and comparison with 4FGL}
\lb{sec:3FGLprediction}


In this section we use of the selected algorithms from the previous section to predict classes for the unassociated sources in the 3FGL. 
We then use the associations, which exist for some of these sources in the 4FGL, to check the accuracy of our methods on the unassociated data.  A total of 286 such sources were identified. These contain 20 pulsars and 266 AGNs.

%\subsection{Unassociated sources in 3FGL with associations in 4FGL}
%There were a total of 286 sources without associations in 3FGL but associations in 4FGL. We trained our algorithms on the entire set of associated data from the 3FGL, and then tested our algorithms on these 286 sources. The probabilistic version is discussed in the next section.  \\

Accuracies of our chosen algorithms are given in table 2, averaged over 1000 runs. It contains both training and testing accuracies, where testing now refers to the 3FGL unassociated data with associations in 4FGL. 


\begin{table}[!h]
    \tiny
 %  \centering
    \renewcommand{\tabcolsep}{0.3mm}
\renewcommand{\arraystretch}{1.5}

    \begin{tabular}{|c|c|c|c|}
    \hline
    Algorithm&Parameters & Training Accuracy & Testing Accuracy\\
    \hline
    RF& 50 trees, max depth 6  &97.69& 95.76   \\
    \hline
    NN & 300, 10 Neurons, Adam & 97.40& 95.35 \\
    \hline %\midrule   -> aakash do you mean this?
    BDT & 100 trees, max depth 2    &   97.80&95.45  \\
%    \hline %\midrule   -> aakash do you mean this?
%    BDT & 200 trees, max depth 2    &   95.8  \\
    \hline
    LR & LBFGS solver, 200 iterations & 97.6&87.14 (balanced), 95.08 \\
    \hline
     
    \end{tabular}

    \caption{Accuracy of the 4 selected algorithms on 3FGL unassociated data.}
    \label{tab:selected_algs}
\end{table}

%As can be seen above, the best accuracies were found with less complicated models, which allowed bias to be low. The models were complicated enough to neither under, nor overtrain.

%Feature importance for RF: [0.         0.         0.12236186 0.31656891 0.12013348 0.04952569  0.05523149 0.05632573 0.23685429 0.04299855]



\subsection{3FGL Probabilistic classification} 

Here we discuss the results of our probabilistic classification on the unassociated data.
\begin{figure*}[h]
%\centerin
\includegraphics[width=\textwidth]{plots/plot_4fglassoc_3fglunassoc_242.pdf}
%\includegraphics[width=\twopicsp\textwidth]{plots/PSR3.pdf}
\caption{Comparison of class prediction for unassociated 3FGL sources with classes in 4FGL. }
%\includegraphics[width=\twopicsp\textwidth]{plots/final_catalog.pdf}
\label{fig:Maps_data}
\end{figure*}

%\csvreader[tabular=|l|l|c|,
  %  table head=\hline & Source Name &Flux \\\hline,
 %   late after line=\\\hline,
%filter={\value{csvrow}<2},]%%
%{data/3fglunassoc_4fglassoc_withprob.csv}{Source_Name_3FGL=\source,ln(Flux_Density_3FGL)=\flux}%
%{\thecsvrow & \source & \flux}



\pgfplotstableread[col sep=comma]{data/3fgl.csv}\loadedtable
\pgfplotstabletypeset[columns={Source_Name_3FGL,AGN_BDT,AGN_RF,AGN_LR,AGN_NN},
column type=l,
string type,
every head row/.style={before row={\toprule & \multicolumn{4}{c}{AGN Probability} \\},after row=\midrule,},
every last row/.style={after row=\vdots },
%every first column/.style={column type/.add={|}{}},
%every last column/.style={column type/.add={}{|}},
columns/Source_Name_3FGL/.style={column name=Source Name},
columns/AGN_BDT/.style={column name=BDT,numeric type,fixed,precision=3},
columns/AGN_NN/.style={column name=NN,numeric type,fixed,precision=3},
columns/AGN_RF/.style={column name=RF,numeric type,fixed,precision=3},
columns/AGN_LR/.style={column name=LR,numeric type,fixed,precision=3},
skip rows between index={4}{242}
]\loadedtable

%\pgfplotstabletypeset[
%    col sep=comma,
 %   string type,
%table head=\hline & Source Name &Flux \\\hline
 %  every head row/.style={ before row={\hline\multicolumn{2}{c}{Full Name} & \\ },after row=\hline},
    %every last row/.style={after row=\hline},
  %  columns/hr12/.style={column name=Name, column type=l},
   % columns/hr23/.style={column name=Surname, column type=l},
   % columns/hr34/.style={column name=Age, column type=c},
  %  ]
