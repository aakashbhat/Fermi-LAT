\section{Conclusions}
\lb{sec:conclusions}

In this paper we determine the probabilities of classification of unassociated sources in the 3FGL and 4FGL-DR2 \Fermi-LAT catalogs
into two (AGNs and pulsars) and three (AGNs, pulsars, and other sources) classes.
The probabilities are calculated with 8 different ML methods: RF, BDT, LR and NN -- each algorithm with and without oversampling during training.
The algorithms were trained and tested with associated sources.
We have scanned some meta-parameters of the algorithms, such as depth of the trees, the number of trees, the number of neurons, in order to determine optimal parameters which do not create overfitting of data and provide good accuracy of classification.
The accuracies, which we obtained for the 3FGL catalog for the four algorithms without oversampling in the 2-class case are about 97\%, and between 93\% and 97\% with oversampling.
We have also checked the accuracy of classification by selecting unassociated sources in 3FGL, which have associations in 4FGL-DR2.
If we take the 4FGL-DR2 associations as the true classes, then the accuracies of classification in this subset of sources 
without (with) oversampling are between 90\% and 91\% (85\% and 92\%).
Most of misclassified sources in this comparison have spectral parameters in 3FGL which are typical of the other class (Figure \ref{fig:3FGL_vs_4FGL_classes}), i.e.,  the misclassification can be due to problems with reconstructing the spectrum of the sources.
In the 3-class classification, the testing accuracies for the 3FGL catalog are between 92\% and 94\% (both with and without oversampling), while comparison with 4FGL-DR2 give accuracy between 82\% and 85\%. For the 4FGL-DR2 classifications, the testing accuracy is between 90\% and 93\% (both with and without oversampling). If one takes into account that all other sources are misclassified in the 2-class case, then the 3-class case provides an improvement in accuracy of 1\% to 5\%.

We have created four catalogs with probabilistic classifications of sources: based on 3FGL and on 4FGL-DR2 with 2- and 3-class classifications.
For each source and for each class we report class probabilities for each of the eight ML methods (with and without oversampling). 
We also provide individual standard deviations for all classification probabilities by using sample average over selection of training and testing datasets.
We report the classification probabilities not only for the unassociated sources, but also for the associated ones, which can be used to find outliers.
An advantage of such probabilistic classification is that a threshold on probability for selecting, e.g., pulsar candidates, can be chosen by the user based on his or her needs.
For example, in a search of new pulsars, one can select a low threshold in order to avoid missing possible pulsars.
In a derivation of an average property of the class, e.g., spectral index or cutoff energy, one can select a high threshold in order to avoid contamination from the other classes.


As an example of the application of the probabilistic catalogs, we derive the expected number of sources in the catalog as a function of their flux, including the unassociated sources.
As a consistency check, we compare the counts of associated sources to the sums of probabilities for the associated ones.
We find that correcting for the contribution of other sources in the 2-class case plays an important role for the estimation of the expected number of sources in a particular class.
We find the total expected number of AGNs and pulsars in the 3FGL and 4FGL catalogs by adding the class probabilities for the unassociated sources in the 2- and 3-class cases to the source counts of associated sources and correcting in the 2-class case for the contribution of other classes in the unassociated sources.
In particular, we find that the total expected number of pulsars is about two times larger than the number of associated pulsars.

We plot the counts of associated sources and the expected numbers of AGNs, pulsars, and other sources among unassociated sources
as functions of Galactic latitude and longitude.
We find that the number of associated AGNs is decreasing towards low latitudes, while the expected number of AGNs among unassociated sources is increasing, so that the sum of the two is relatively uniform, as expected for extragalactic sources.


\subsection*{Acknowledgements}

The authors would like to thank Pablo Saz Parkinson and Jean Ballet for valuable discussions.
The work of DM was in part supported by BMBF under the ErUM-Data project ``Innovative Digital Technologies for Research on Universe and Matter'' (grant number 05H18WERC1) and by DFG grant MA 8279/2-1.
We would like to acknowledge the use of the following software:
Astropy \citep[\url{http://www.astropy.org},][]{2013A&A...558A..33A}, 
matplotlib \citep{Hunter:2007}, 
scikit-learn [\url{https://scikit-learn.org/stable/about.html}], 
TOPCAT \citep{2005ASPC..347...29T}.
